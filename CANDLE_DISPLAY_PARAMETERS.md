# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–≤–µ—á–µ–π

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2026-01-29  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2026-01-29 (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)  
**–¶–µ–ª—å**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–µ—á–µ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö –∏ –ø—Ä–∏ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω—è—Ö zoom

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ**: `candleWidth <= distanceBetweenCenters - GAP`

–®–∏—Ä–∏–Ω–∞ —Å–≤–µ—á–∏ **–ù–ï –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω–æ–π** (–∫–∞–∫ –±—ã–ª–æ —Å `MIN_CANDLE_PX`). –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç **–ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π**, –∞ –Ω–µ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞.

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ**:
- ‚ùå –ê–±—Å–æ–ª—é—Ç–Ω—ã–π `MIN_CANDLE_PX` –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏
- ‚ùå –ù–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö `MIN_CANDLE_PX > distance` ‚Üí –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–≤–µ—á–µ–π
- ‚úÖ –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –Ω–∞ –ª—é–±—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö

---

## üìê –®–∏—Ä–∏–Ω–∞ —Å–≤–µ—á–∏

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ (zoom in)

**–§–∞–π–ª**: `frontend/components/chart/internal/render/renderCandles.ts`

```typescript
const MAX_CANDLE_PX = 200; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Å–≤–µ—á–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö (–¥–ª—è zoom in)
const CANDLE_GAP = 0.5;    // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏ –≤ –ø–∏–∫—Å–µ–ª—è—Ö
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- `MAX_CANDLE_PX` - –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —à–∏—Ä–∏–Ω—É —Å–≤–µ—á–∏ –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom in
- `CANDLE_GAP` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Å–≤–µ—á–∞–º–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
1. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è `rawWidth = (timeframeMs / timeRange) * width` (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏)
2. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è `effectiveMaxWidth = rawWidth - CANDLE_GAP` (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —à–∏—Ä–∏–Ω–∞)
3. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è clamp: `candleWidth = Math.min(MAX_CANDLE_PX, Math.min(rawWidth, effectiveMaxWidth))`

**–§–æ—Ä–º—É–ª–∞**:
```
distanceBetweenCenters = (timeframeMs / timeRange) * canvasWidth
effectiveMaxWidth = distanceBetweenCenters - CANDLE_GAP
finalCandleWidth = clamp(rawWidth, 0, min(MAX_CANDLE_PX, effectiveMaxWidth))
```

**–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- –ú–∞–∫—Å–∏–º—É–º (zoom in): **200px**
- –ó–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏: **0.5px**
- –ú–∏–Ω–∏–º—É–º: **0px** (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–≤–µ—á–µ–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ –ù–∞ –ª—é–±—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö —Å–≤–µ—á–∏ –≤—ã–≥–ª—è–¥—è—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìè –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Å–≤–µ—á–∏

### –®–∏—Ä–∏–Ω–∞ —Ç–µ–ª–∞ —Å–≤–µ—á–∏

**–§–∞–π–ª**: `frontend/components/chart/internal/render/renderCandles.ts`

```typescript
const CANDLE_BODY_WIDTH_RATIO = 0.7; // –®–∏—Ä–∏–Ω–∞ —Ç–µ–ª–∞ —Å–≤–µ—á–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —à–∏—Ä–∏–Ω—ã —Å–≤–µ—á–∏
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å –æ–±—â–µ–π —à–∏—Ä–∏–Ω—ã —Å–≤–µ—á–∏ –∑–∞–Ω–∏–º–∞–µ—Ç —Ç–µ–ª–æ (–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ open-close)
- –û—Å—Ç–∞–ª—å–Ω—ã–µ 30% - —ç—Ç–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø–æ –±–æ–∫–∞–º –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

**–†–∞—Å—á–µ—Ç**:
- `bodyWidth = candleWidth * 0.7`
- –¢–µ–ª–æ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ü–µ–Ω—Ç—Ä–∞ —Å–≤–µ—á–∏

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: **0.7** (70% –æ—Ç —à–∏—Ä–∏–Ω—ã —Å–≤–µ—á–∏)

---

### –®–∏—Ä–∏–Ω–∞ —Ñ–∏—Ç–∏–ª—è (wick)

**–§–∞–π–ª**: `frontend/components/chart/internal/render/renderCandles.ts`

```typescript
const WICK_WIDTH = 1; // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ñ–∏—Ç–∏–ª—è –≤ –ø–∏–∫—Å–µ–ª—è—Ö
```

**–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ñ–∏—Ç–∏–ª—è**:
- –ü—Ä–∏ `candleWidth <= 2px`: `wickWidth = Math.max(0.5, candleWidth / 2)`
- –ü—Ä–∏ `candleWidth > 2px`: `wickWidth = 1px`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –§–∏—Ç–∏–ª—å (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è –æ—Ç high –¥–æ low) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç–æ–Ω—å—à–µ –ø—Ä–∏ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–≤–µ—á–∞—Ö
- –≠—Ç–æ —É–ª—É—á—à–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –≤–æ—Å–ø—Ä–∏—è—Ç–∏–µ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º zoom out

**–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —à–∏—Ä–∏–Ω–∞: **1px**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞: **0.5px** (–ø—Ä–∏ –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–≤–µ—á–∞—Ö)

---

## üéØ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ

### –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π

**–§–∞–π–ª**: `frontend/components/chart/internal/useViewport.ts`

```typescript
const DEFAULT_CONFIG: ViewportConfig = {
  visibleCandles: 60,  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  yPaddingRatio: 0.1,
  rightPaddingRatio: 0.35,
};
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä–∞—Ñ–∏–∫–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ `timeRange`: `timeRange = visibleCandles * timeframeMs`

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: **60 —Å–≤–µ—á–µ–π**

---

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π (zoom limits)

**–§–∞–π–ª**: `frontend/components/chart/internal/interactions/useChartInteractions.ts`

```typescript
const MIN_VISIBLE_CANDLES = 20;   // –ú–∏–Ω–∏–º—É–º —Å–≤–µ—á–µ–π –ø—Ä–∏ zoom in
const MAX_VISIBLE_CANDLES = 300; // –ú–∞–∫—Å–∏–º—É–º —Å–≤–µ—á–µ–π –ø—Ä–∏ zoom out
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—Ç –¥–∏–∞–ø–∞–∑–æ–Ω zoom —á–µ—Ä–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ `timeRange`
- `minTimeRange = MIN_VISIBLE_CANDLES * timeframeMs`
- `maxTimeRange = MAX_VISIBLE_CANDLES * timeframeMs`

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
- –ü—Ä–∏ zoom in: `timeRange` –Ω–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –º–µ–Ω—å—à–µ `20 * 5000ms = 100,000ms` (100 —Å–µ–∫—É–Ω–¥)
- –ü—Ä–∏ zoom out: `timeRange` –Ω–µ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –±–æ–ª—å—à–µ `300 * 5000ms = 1,500,000ms` (1500 —Å–µ–∫—É–Ω–¥ = 25 –º–∏–Ω—É—Ç)

**–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- –ú–∏–Ω–∏–º—É–º: **20 —Å–≤–µ—á–µ–π**
- –ú–∞–∫—Å–∏–º—É–º: **300 —Å–≤–µ—á–µ–π**

---

## üîç Zoom —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–§–∞–π–ª**: `frontend/components/chart/internal/interactions/useChartInteractions.ts`

```typescript
const ZOOM_SENSITIVITY = 0.1; // 10% –∑–∞ —à–∞–≥ –∫–æ–ª–µ—Å–∏–∫–∞
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç zoom –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –∫–æ–ª–µ—Å–∏–∫–∞ –º—ã—à–∏
- `zoomFactor = deltaY < 0 ? 1 - ZOOM_SENSITIVITY : 1 + ZOOM_SENSITIVITY`
- –°–∫—Ä–æ–ª–ª –≤–≤–µ—Ä—Ö (zoom in): `zoomFactor = 0.9` (—É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 10%)
- –°–∫—Ä–æ–ª–ª –≤–Ω–∏–∑ (zoom out): `zoomFactor = 1.1` (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 10%)

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: **0.1** (10% –∑–∞ —à–∞–≥)

---

## üìä –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–µ—Ö–∞–Ω–∏–∑–º**: –°–≤–µ—á–∏ —Ü–µ–Ω—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–§–æ—Ä–º—É–ª–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**:
```typescript
// –¶–µ–Ω—Ç—Ä —Å–≤–µ—á–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (—Å–µ—Ä–µ–¥–∏–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞)
const candleCenterTime = candle.startTime + timeframeMs / 2;
const centerX = timeToX(candleCenterTime, viewport, width);

// –°–≤–µ—á–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ centerX
// –§–∏—Ç–∏–ª—å —Ä–∏—Å—É–µ—Ç—Å—è –ø–æ centerX
// –¢–µ–ª–æ —Å–≤–µ—á–∏: centerX - bodyWidth/2 –¥–æ centerX + bodyWidth/2
```

**–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Å–≤–µ—á–∞–º–∏**:
- –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏: `distance = |centerX2 - centerX1|`
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç `timeRange` –∏ `timeframeMs`
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º `timeRange` (zoom out) —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
- –ü—Ä–∏ –º–∞–ª–æ–º `timeRange` (zoom in) —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è

**–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è**:
```
distance = |timeToX(candle2.startTime + timeframeMs/2) - timeToX(candle1.startTime + timeframeMs/2)|
         = |((candle2.startTime + timeframeMs/2 - timeStart) / timeRange) * width - 
            ((candle1.startTime + timeframeMs/2 - timeStart) / timeRange) * width|
         = |(candle2.startTime - candle1.startTime) / timeRange| * width
         = (timeframeMs / timeRange) * width  // –¥–ª—è —Å–æ—Å–µ–¥–Ω–∏—Ö —Å–≤–µ—á–µ–π
```

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è**:
- –ü—Ä–∏ —Å–∏–ª—å–Ω–æ–º zoom out —Å–≤–µ—á–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ `distance < candleWidth`
- –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ `(timeframeMs / timeRange) * width < MIN_CANDLE_PX`
- –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ `timeRange = 1,500,000ms` –∏ `width = 1000px`:
  - `distance = (5000 / 1,500,000) * 1000 = 3.33px`
  - –ù–æ `candleWidth = clamp(3.33, 10, 200) = 10px`
  - –†–µ–∑—É–ª—å—Ç–∞—Ç: `distance (3.33px) < candleWidth (10px)` ‚Üí –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ

**–¢–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ**:
- –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã—á–∏—Å–ª—è—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Å–≤–µ—á–∞–º–∏
- –ò –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å `candleWidth` —Ç–∞–∫, —á—Ç–æ–±—ã `candleWidth <= minDistance - gap`
- –ì–¥–µ `gap` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.5-1px)

**–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è

---

## üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –¶–≤–µ—Ç–∞ —Å–≤–µ—á–µ–π

**–§–∞–π–ª**: `frontend/components/chart/internal/render/renderCandles.ts`

```typescript
const GREEN_COLOR = '#10b981'; // green-500 - –¥–ª—è —Ä–∞—Å—Ç—É—â–∏—Ö —Å–≤–µ—á–µ–π (close >= open)
const RED_COLOR = '#ef4444';   // red-500 - –¥–ª—è –ø–∞–¥–∞—é—â–∏—Ö —Å–≤–µ—á–µ–π (close < open)
```

**–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**:
- –ó–µ–ª–µ–Ω—ã–π: **#10b981** (Tailwind green-500)
- –ö—Ä–∞—Å–Ω—ã–π: **#ef4444** (Tailwind red-500)

---

## üìê –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–µ—á–∏

### –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏

**–ú–µ—Ö–∞–Ω–∏–∑–º**: –°–≤–µ—á–∞ –≤—Å–µ–≥–¥–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞

**–§–æ—Ä–º—É–ª–∞**:
```typescript
const candleCenterTime = candle.startTime + timeframeMs / 2;
const centerX = timeToX(candleCenterTime, viewport, width);
```

**–í–∞–∂–Ω–æ**:
- –¶–µ–Ω—Ç—Ä —Å–≤–µ—á–∏ –≤—Å–µ–≥–¥–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–µ—Ä–µ–¥–∏–Ω–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—Ç–∞ (`startTime + timeframeMs / 2`)
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–∂–µ –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π —à–∏—Ä–∏–Ω–µ —Å–≤–µ—á–∏
- –°–≤–µ—á–∏ –Ω–µ —Å–º–µ—â–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —à–∏—Ä–∏–Ω—ã —á–µ—Ä–µ–∑ clamp

---

## üî¢ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –ø–∞–º—è—Ç–∏

**–§–∞–π–ª**: `frontend/components/chart/internal/useChartData.ts`

```typescript
const MAX_CANDLES = 3000; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –≤ –ø–∞–º—è—Ç–∏
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**:
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π, —Ö—Ä–∞–Ω—è—â–∏—Ö—Å—è –≤ –ø–∞–º—è—Ç–∏
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ —É–¥–∞–ª—è—é—Ç—Å—è —Å–∞–º—ã–µ –Ω–æ–≤—ã–µ —Å–≤–µ—á–∏ (–∏–∑ –∫–æ–Ω—Ü–∞ –º–∞—Å—Å–∏–≤–∞)
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ

**–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: **3000 —Å–≤–µ—á–µ–π**

---

## üì± –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã

### –ö–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

**–ö–ª—é—á–µ–≤–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –ª—é–±–æ–π —ç–∫—Ä–∞–Ω!

#### –ú–∞–ª–µ–Ω—å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã (–º–æ–±–∏–ª—å–Ω—ã–µ, ~375px —à–∏—Ä–∏–Ω–∞)
- –ü—Ä–∏ `visibleCandles = 60` –∏ `timeframeMs = 5000ms`:
  - `timeRange = 60 * 5000 = 300,000ms` (5 –º–∏–Ω—É—Ç)
  - `rawWidth = (5000 / 300,000) * 375 = 6.25px`
  - `effectiveMaxWidth = 6.25 - 0.5 = 5.75px`
  - –ü–æ—Å–ª–µ clamp: `candleWidth = min(200, min(6.25, 5.75)) = 5.75px` ‚úÖ

#### –°—Ä–µ–¥–Ω–∏–µ —ç–∫—Ä–∞–Ω—ã (–ø–ª–∞–Ω—à–µ—Ç—ã, ~768px —à–∏—Ä–∏–Ω–∞)
- –ü—Ä–∏ —Ç–µ—Ö –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö:
  - `rawWidth = (5000 / 300,000) * 768 = 12.8px`
  - `effectiveMaxWidth = 12.8 - 0.5 = 12.3px`
  - –ü–æ—Å–ª–µ clamp: `candleWidth = min(200, min(12.8, 12.3)) = 12.3px` ‚úÖ

#### –ë–æ–ª—å—à–∏–µ —ç–∫—Ä–∞–Ω—ã (–¥–µ—Å–∫—Ç–æ–ø, ~1920px —à–∏—Ä–∏–Ω–∞)
- –ü—Ä–∏ —Ç–µ—Ö –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö:
  - `rawWidth = (5000 / 300,000) * 1920 = 32px`
  - `effectiveMaxWidth = 32 - 0.5 = 31.5px`
  - –ü–æ—Å–ª–µ clamp: `candleWidth = min(200, min(32, 31.5)) = 31.5px` ‚úÖ

**–í—ã–≤–æ–¥**: 
- ‚úÖ –ù–∞ –ª—é–±—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö —Å–≤–µ—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –ø–æ–¥ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- ‚úÖ –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `effectiveMaxWidth`
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤

---

## üîÑ –í–∑–∞–∏–º–æ—Å–≤—è–∑—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ —à–∏—Ä–∏–Ω—ã —Å–≤–µ—á–∏ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è)

```
1. rawWidth = (timeframeMs / timeRange) * canvasWidth  // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏
2. distanceBetweenCenters = rawWidth
3. effectiveMaxWidth = distanceBetweenCenters - CANDLE_GAP
4. candleWidth = min(MAX_CANDLE_PX, min(rawWidth, effectiveMaxWidth))
5. bodyWidth = candleWidth * CANDLE_BODY_WIDTH_RATIO
6. wickWidth = candleWidth <= 2 ? max(0.5, candleWidth / 2) : 1
```

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ**: –®–∏—Ä–∏–Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ **—Å–Ω–∏–∑—É** –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–º –º–∏–Ω–∏–º—É–º–æ–º, –∞ **—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏**.

### –§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞ timeRange (zoom)

```
1. currentTimeRange = viewport.timeEnd - viewport.timeStart
2. newTimeRange = currentTimeRange * zoomFactor
3. clampedTimeRange = clamp(newTimeRange, 
                            MIN_VISIBLE_CANDLES * timeframeMs,
                            MAX_VISIBLE_CANDLES * timeframeMs)
```

### –í–∑–∞–∏–º–æ—Å–≤—è–∑—å

- **Zoom in** ‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è `timeRange` ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è `rawWidth` ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è `effectiveMaxWidth` ‚Üí —Å–≤–µ—á–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —à–∏—Ä–µ (–¥–æ MAX_CANDLE_PX)
- **Zoom out** ‚Üí —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è `timeRange` ‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è `rawWidth` ‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è `effectiveMaxWidth` ‚Üí —Å–≤–µ—á–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —É–∂–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞)

**–í–∞–∂–Ω–æ**: –ü—Ä–∏ —Å–∏–ª—å–Ω–æ–º zoom out —Å–≤–µ—á–∏ –º–æ–≥—É—Ç —Å—Ç–∞—Ç—å –æ—á–µ–Ω—å —Ç–æ–Ω–∫–∏–º–∏ (–¥–∞–∂–µ < 1px), –Ω–æ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –±–ª–∞–≥–æ–¥–∞—Ä—è `effectiveMaxWidth`.

---

## ‚öôÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–ù–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã!** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è.

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**MAX_CANDLE_PX** (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –ø—Ä–∏ zoom in):
- **–ú–æ–±–∏–ª—å–Ω—ã–µ**: 30-50px (—Ç–æ–ª—Å—Ç—ã–µ —Å–≤–µ—á–∏ –∑–∞–Ω–∏–º–∞—é—Ç –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞)
- **–ü–ª–∞–Ω—à–µ—Ç—ã**: 50-100px
- **–î–µ—Å–∫—Ç–æ–ø**: 100-200px (–±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏)
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: 200px (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ)

**CANDLE_GAP** (–∑–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏):
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π**: 0.3px (–ø–æ—á—Ç–∏ –Ω–µ–∑–∞–º–µ—Ç–Ω—ã–π –∑–∞–∑–æ—Ä)
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π**: 0.5px (—Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å)
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π**: 1px (–±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ)
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**: 0.5px

**MIN_VISIBLE_CANDLES / MAX_VISIBLE_CANDLES**:
- **MIN_VISIBLE_CANDLES = 20**: –ú–∏–Ω–∏–º—É–º –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ zoom in
- **MAX_VISIBLE_CANDLES = 300**: –ú–∞–∫—Å–∏–º—É–º –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ zoom out –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏

### ‚ùå –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å

- ‚ùå **MIN_CANDLE_PX** - —É–±—Ä–∞–Ω, –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω
- ‚ùå –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ - –Ω–µ –Ω—É–∂–Ω—ã
- ‚ùå –†–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö/–¥–µ—Å–∫—Ç–æ–ø - –Ω–µ –Ω—É–∂–Ω—ã

---

## ‚úÖ –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–≤–µ—á–µ–π –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º zoom out

**–ü—Ä–∏—á–∏–Ω–∞ (—Å—Ç–∞—Ä–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)**: –ê–±—Å–æ–ª—é—Ç–Ω—ã–π `MIN_CANDLE_PX` –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª —Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã (—Å—Ç–∞—Ä–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)**:
```
timeRange = 1,500,000ms (MAX_VISIBLE_CANDLES = 300)
canvasWidth = 1000px
timeframeMs = 5000ms

–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Å–≤–µ—á–∞–º–∏:
distance = (5000 / 1,500,000) * 1000 = 3.33px

–ù–æ candleWidth –ø–æ—Å–ª–µ clamp (–°–¢–ê–†–´–ô –ö–û–î):
rawWidth = 3.33px
candleWidth = max(MIN_CANDLE_PX, 3.33) = max(10, 3.33) = 10px

–†–µ–∑—É–ª—å—Ç–∞—Ç: 3.33px < 10px ‚Üí —Å–≤–µ—á–∏ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è! ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)**:
```typescript
// –í—ã—á–∏—Å–ª—è–µ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–∞–º–∏ (—ç—Ç–æ –∂–µ rawWidth)
const distanceBetweenCenters = (timeframeMs / timeRange) * width;

// –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–æ–ø—É—Å—Ç–∏–º–∞—è —à–∏—Ä–∏–Ω–∞ = —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ - –∑–∞–∑–æ—Ä
const effectiveMaxWidth = Math.max(0, distanceBetweenCenters - CANDLE_GAP);

// –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
const candleWidth = Math.min(
  MAX_CANDLE_PX,                    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É (zoom in)
  Math.max(0, Math.min(rawWidth, effectiveMaxWidth))  // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–Ω–∏–∑—É (–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ)
);
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã (–Ω–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)**:
```
distanceBetweenCenters = 3.33px
effectiveMaxWidth = 3.33 - 0.5 = 2.83px
candleWidth = min(200, min(3.33, 2.83)) = 2.83px

–†–µ–∑—É–ª—å—Ç–∞—Ç: 2.83px < 3.33px ‚Üí –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ! ‚úÖ
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ `renderCandles.ts`

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã

- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª–µ–≤—É—é —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞ (–º–æ–±–∏–ª—å–Ω—ã–π/–ø–ª–∞–Ω—à–µ—Ç/–¥–µ—Å–∫—Ç–æ–ø)
- [ ] –†–∞—Å—Å—á–∏—Ç–∞—Ç—å `rawWidth` –¥–ª—è –¥–µ—Ñ–æ–ª—Ç–Ω–æ–≥–æ `visibleCandles = 60`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `rawWidth` –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω `[MIN_CANDLE_PX, MAX_CANDLE_PX]`
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `MIN_CANDLE_PX` –∏ `MAX_CANDLE_PX`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom out —Å–≤–µ—á–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom in —Å–≤–µ—á–∏ –Ω–µ —Å–ª–∏—à–∫–æ–º —Ç–æ–ª—Å—Ç—ã–µ
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ñ–∏—Ç–∏–ª—å –≤–∏–¥–µ–Ω –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö zoom
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö —ç–∫—Ä–∞–Ω–∞

---

## üìç –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∫–æ–¥–µ

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

1. **–®–∏—Ä–∏–Ω–∞ —Å–≤–µ—á–∏ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
   - `frontend/components/chart/internal/render/renderCandles.ts`
   - –°—Ç—Ä–æ–∫–∏ 22-29

2. **Zoom –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**:
   - `frontend/components/chart/internal/interactions/useChartInteractions.ts`
   - –°—Ç—Ä–æ–∫–∏ 44-46

3. **–î–µ—Ñ–æ–ª—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è viewport**:
   - `frontend/components/chart/internal/useViewport.ts`
   - –°—Ç—Ä–æ–∫–∏ 63-67

4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**:
   - `frontend/components/chart/internal/useChartData.ts`
   - –°—Ç—Ä–æ–∫–∞ 459

---

## üéØ –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å–≤–æ–¥–∫–∞)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –§–∞–π–ª | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|----------|------|------------|
| ~~MIN_CANDLE_PX~~ | ~~10px~~ | ~~renderCandles.ts:28~~ | ‚ùå **–£–ë–†–ê–ù** - –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω |
| MAX_CANDLE_PX | 200px | renderCandles.ts:28 | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É (zoom in) |
| CANDLE_GAP | 0.5px | renderCandles.ts:29 | –ó–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏ |
| CANDLE_BODY_WIDTH_RATIO | 0.7 | renderCandles.ts:22 | –ü—Ä–æ–ø–æ—Ä—Ü–∏—è —Ç–µ–ª–∞ —Å–≤–µ—á–∏ |
| WICK_WIDTH | 1px | renderCandles.ts:23 | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ñ–∏—Ç–∏–ª—è |
| visibleCandles (default) | 60 | useViewport.ts:64 | –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π |
| MIN_VISIBLE_CANDLES | 20 | useChartInteractions.ts:44 | –ú–∏–Ω–∏–º—É–º –¥–ª—è zoom in |
| MAX_VISIBLE_CANDLES | 300 | useChartInteractions.ts:45 | –ú–∞–∫—Å–∏–º—É–º –¥–ª—è zoom out |
| ZOOM_SENSITIVITY | 0.1 | useChartInteractions.ts:46 | –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å zoom |
| MAX_CANDLES (memory) | 3000 | useChartData.ts:459 | –õ–∏–º–∏—Ç —Å–≤–µ—á–µ–π –≤ –ø–∞–º—è—Ç–∏ |

---

## üîß –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### –ò–∑–º–µ–Ω–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —à–∏—Ä–∏–Ω—É —Å–≤–µ—á–∏ (zoom in)

1. –û—Ç–∫—Ä–æ–π—Ç–µ `frontend/components/chart/internal/render/renderCandles.ts`
2. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `MAX_CANDLE_PX` (—Å—Ç—Ä–æ–∫–∞ 28)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom in

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
- –ú–æ–±–∏–ª—å–Ω—ã–µ: 30-50px
- –ü–ª–∞–Ω—à–µ—Ç—ã: 50-100px
- –î–µ—Å–∫—Ç–æ–ø: 100-200px

### –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–∑–æ—Ä –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ `frontend/components/chart/internal/render/renderCandles.ts`
2. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `CANDLE_GAP` (—Å—Ç—Ä–æ–∫–∞ 29)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–≤–µ—á–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π: 0.3px
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π: 0.5px
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π: 1px

### –ò–∑–º–µ–Ω–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω zoom

1. –û—Ç–∫—Ä–æ–π—Ç–µ `frontend/components/chart/internal/interactions/useChartInteractions.ts`
2. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è `MIN_VISIBLE_CANDLES` –∏ `MAX_VISIBLE_CANDLES` (—Å—Ç—Ä–æ–∫–∏ 44-45)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É zoom

### –ò–∑–º–µ–Ω–∏—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ `frontend/components/chart/internal/useViewport.ts`
2. –ò–∑–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `visibleCandles` –≤ `DEFAULT_CONFIG` (—Å—Ç—Ä–æ–∫–∞ 64)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—Å—è –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä–∞—Ñ–∏–∫–∞

### ‚ùå –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å

- ‚ùå **MIN_CANDLE_PX** - —É–±—Ä–∞–Ω, –±–æ–ª—å—à–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚ùå –ú–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —ç–∫—Ä–∞–Ω–æ–≤ - –Ω–µ –Ω—É–∂–Ω—ã

---

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–æ–≤ (–Ω–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

### –ü—Ä–∏–º–µ—Ä 1: –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (visibleCandles = 60, canvasWidth = 1000px)

```
timeRange = 60 * 5000 = 300,000ms
rawWidth = (5000 / 300,000) * 1000 = 16.67px
distanceBetweenCenters = 16.67px
effectiveMaxWidth = 16.67 - 0.5 = 16.17px
candleWidth = min(200, min(16.67, 16.17)) = 16.17px ‚úÖ
bodyWidth = 16.17 * 0.7 = 11.32px
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π zoom in (MIN_VISIBLE_CANDLES = 20, canvasWidth = 1000px)

```
timeRange = 20 * 5000 = 100,000ms
rawWidth = (5000 / 100,000) * 1000 = 50px
distanceBetweenCenters = 50px
effectiveMaxWidth = 50 - 0.5 = 49.5px
candleWidth = min(200, min(50, 49.5)) = 49.5px ‚úÖ
bodyWidth = 49.5 * 0.7 = 34.65px
```

### –ü—Ä–∏–º–µ—Ä 3: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π zoom out (MAX_VISIBLE_CANDLES = 300, canvasWidth = 1000px)

```
timeRange = 300 * 5000 = 1,500,000ms
rawWidth = (5000 / 1,500,000) * 1000 = 3.33px
distanceBetweenCenters = 3.33px
effectiveMaxWidth = 3.33 - 0.5 = 2.83px
candleWidth = min(200, min(3.33, 2.83)) = 2.83px ‚úÖ (–Ω–µ 10px!)
bodyWidth = 2.83 * 0.7 = 1.98px
```

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ**: –ü—Ä–∏ zoom out —Å–≤–µ—á–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ç–æ–Ω—å—à–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –±–µ–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞. –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ!

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ì—Ä–∞—Ñ–∏–∫ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º, –µ—Å–ª–∏:

1. ‚úÖ **–ò–Ω–≤–∞—Ä–∏–∞–Ω—Ç —Å–æ–±–ª—é–¥–µ–Ω**: `candleWidth <= distanceBetweenCenters - GAP` –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö –∏ zoom —É—Ä–æ–≤–Ω—è—Ö
2. ‚úÖ –ü—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom in —Å–≤–µ—á–∏ –Ω–µ —Å–ª–∏—à–∫–æ–º —Ç–æ–ª—Å—Ç—ã–µ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã MAX_CANDLE_PX)
3. ‚úÖ –ü—Ä–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º zoom out —Å–≤–µ—á–∏ –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—Ç—Å—è (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã effectiveMaxWidth)
4. ‚úÖ –§–∏—Ç–∏–ª—å –≤–∏–¥–µ–Ω –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö zoom (—Ä–∏—Å—É–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞, –¥–∞–∂–µ –µ—Å–ª–∏ —Ç–µ–ª–æ –Ω–µ –ø–æ–º–µ—â–∞–µ—Ç—Å—è)
5. ‚úÖ –¢–µ–ª–æ —Å–≤–µ—á–∏ —á–∏—Ç–∞–µ–º–æ (—Ä–∏—Å—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ candleWidth > 0.5px)
6. ‚úÖ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Å–≤–µ—á–∞–º–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–µ (–∑–∞–∑–æ—Ä CANDLE_GAP)
7. ‚úÖ Zoom —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞–≤–Ω–æ –±–µ–∑ —Ä—ã–≤–∫–æ–≤
8. ‚úÖ –ù–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö –≥—Ä–∞—Ñ–∏–∫ –≤—ã–≥–ª—è–¥–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ (–±–µ–∑ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å–æ–≤)
9. ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **2026-01-29**: –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- **2026-01-29**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã —Å–≤–µ—á–∏ (MIN/MAX_CANDLE_PX) - **–°–¢–ê–†–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê**
- **2026-01-29**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Ñ–∏—Ç–∏–ª—è –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–≤–µ—á–µ–π
- **2026-01-29**: –£–≤–µ–ª–∏—á–µ–Ω MAX_VISIBLE_CANDLES —Å 300 –¥–æ 1000 (–ø–æ–∑–∂–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω –∫ 300)
- **2026-01-29**: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–µ–π (–∫–æ—Å—Ç—ã–ª—å)
- **2026-01-29**: ‚úÖ **–ê–†–•–ò–¢–ï–ö–¢–£–†–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**: –£–±—Ä–∞–Ω –∞–±—Å–æ–ª—é—Ç–Ω—ã–π MIN_CANDLE_PX, —à–∏—Ä–∏–Ω–∞ —Ç–µ–ø–µ—Ä—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç: `candleWidth <= distanceBetweenCenters - GAP`
  - –ü–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ —Å–≤–µ—á–µ–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞ –ª—é–±—ã—Ö —ç–∫—Ä–∞–Ω–∞—Ö
  - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –º–µ–¥–∏–∞-–∑–∞–ø—Ä–æ—Å–æ–≤
